# Boolean GRN Pipeline for Drug Target Discovery in Aging – Internal Project Overview

## Project Objective and Scope

The goal of this project is to identify *rejuvenation targets* – genes or gene combinations that can revert aged cells to a more youthful state – by analyzing single-cell RNA sequencing data across different ages. The pipeline focuses on modeling age-related changes within specific cell types as a dynamic trajectory from a “young” state to an “old” state. By constructing a **Boolean gene regulatory network (GRN)** that captures key regulatory interactions along this trajectory, we can simulate how gene perturbations affect cell state stability. In essence, the scope spans from raw single-cell transcriptomics data, through cell clustering and pseudotemporal ordering, to building an executable Boolean network that predicts the effects of gene knockdowns/overexpressions. This approach aligns with emerging methods to derive gene network signatures of aging and to screen for interventions that reverse aging phenotypes. Ultimately, the pipeline produces ranked candidate targets (single genes or pairs) whose in silico perturbation shifts the network’s attractor state toward a younger profile, suggesting potential therapeutic avenues to *reduce the signs of aging*.

## Pipeline Architecture

The analysis workflow is organized into a sequence of modular stages, each performing specific tasks to transform the input data into testable predictions:

1. **Data Loading and Quality Control:** Single-cell RNA-seq data from multiple samples (donors of various ages) are loaded and merged into a unified dataset. Stringent QC filters are applied to remove low-quality cells – for example, cells with >15% mitochondrial gene content (a sign of apoptosis or damage) or with very few detected genes (<500) are excluded. The expression matrix is then normalized (scaled to a constant total count per cell and log-transformed). Highly variable genes (e.g. top 2,000) are selected to capture informative variation, and standard dimensionality reduction is performed (PCA), followed by initial clustering and UMAP visualization of all cells. This ensures the dataset is clean and that broad patterns (e.g. separation by donor age or batch) can be observed in low dimension. Batch effects due to different donors are mitigated via integration (using donor identity as a batch variable) prior to final clustering and embedding, producing an integrated UMAP colored by age for overview.

2. **Cell Type Identification:** To focus on biologically meaningful aging signals, the pipeline annotates cell types and isolates the most prevalent ones for separate analysis. Using reference transcriptomic atlases (via SingleR with the Human Primary Cell Atlas), each cell is labeled with a putative cell type identity. The three most frequent cell types in the dataset are selected (for example, if analyzing skin tissue, keratinocytes might be a top cell type). For each such cell type, a subset of the data is created and re-processed: variable genes are found, data scaled, and PCA and UMAP are run within that subset to examine its internal structure. This yields cell-type-specific embeddings colored by age, confirming that within a given cell lineage, younger and older cells may occupy different transcriptional states. By saving these cell-type-specific datasets, the pipeline can then trace an aging trajectory *within a homogeneous cell type*, avoiding confounding differences between cell types.

3. **Pseudotime Inference and Smoothing:** For a chosen cell type of interest, the pipeline reconstructs a *pseudotemporal trajectory* that orders cells from young to old. We convert the cell-type Seurat object to a Monocle3 `CellDataSet` and designate all cells from the youngest donors as the *root* of the trajectory (e.g. 18-year-old donor cells as starting point). Monocle3 then performs dimensionality reduction (PCA -> UMAP), clusters the cells, learns a principal graph connecting them, and orders the cells along this graph (pseudotime) starting at the young root cells. Often, the algorithm may discover branch points – multiple possible trajectory paths. The pipeline evaluates each branch and retains the one that most strongly correlates with chronological age progression. In practice, it computes the Pearson correlation between cells’ pseudotime values and their donor ages for each candidate branch, and requires a high positive correlation (e.g. r > 0.6). This step ensures the chosen path genuinely corresponds to an aging progression (younger cells at one end, older at the other), analogous to choosing the biologically relevant trajectory out of several possibilities. Once the principal trajectory is selected, **smoothing** is applied to the gene expression profiles along pseudotime to mitigate single-cell noise. A moving average window (\~10% of the cells in size) slides along the ordered cells, and each gene’s expression is averaged within this window to produce a smoothed expression trend. This yields a smoothed pseudotime-series for each gene, which preserves broad changes with pseudotime while suppressing spiky fluctuations. The smoothed data (stored as a new assay) is used in subsequent steps for robust identification of trends and regulatory relationships.

4. **Differential Expression and Switching Gene Identification:** Next, the pipeline identifies genes that change significantly over the pseudotime trajectory. Monocle’s graph-based test is used on the chosen trajectory to find **differentially expressed genes (DEGs)** whose expression is associated with pseudotime (e.g. genes up- or down-regulated with age). Genes are ranked by significance (q-value) and a cutoff (q < 0.05) is applied. From these, we focus on the set of dynamic genes driving the aging transition. To ensure sufficient network complexity, we require a substantial number of significant genes (in our study, >1000) – if fewer are found, the trajectory is considered not information-rich enough and the process might halt. Using this set of trajectory-associated genes, we then apply the GeneSwitches tool to pinpoint “*switching genes*.” GeneSwitches fits a logistic regression for each gene’s smoothed expression as a function of pseudotime, aiming to detect switch-like on/off behavior. It identifies the pseudotime point where a gene transitions from low (“off”) to high (“on”) expression or vice versa, and computes an R² for how well a sigmoid curve explains the gene’s trajectory profile. We retrieve the top \~1000 switching genes (or all, if fewer) that pass a goodness-of-fit cutoff (e.g. R² > 0.03). These switching genes, together with the broader set of DEGs, represent the most **pseudotime-dynamic genes** in the system. They likely include key regulators and markers of the young-to-old transition. The pipeline proceeds using these genes as the building blocks for the GRN model (all further analysis is constrained to this gene subset).

5. **Gene Regulatory Network (GRN) Inference:** Using the above genes, we construct a directed gene regulatory network that explains their interactions and control logic. This is achieved by integrating data-driven inference with prior biological knowledge:

   * **Co-expression and Regulon Detection (SCENIC):** We employ the SCENIC workflow to infer transcription factor (TF) → target gene relationships from the single-cell data. First, the *GENIE3* algorithm (a random-forest-based method) is run on the smoothed expression matrix to predict regulatory links: for each TF, GENIE3 evaluates how well it can predict the expression of other genes and assigns importance weights. This yields an initial weighted network of candidate TF→target connections. Next, *RcisTarget* (within SCENIC) refines these links by scanning for enriched TF binding motifs in the putative target genes’ promoters/enhancers. In essence, if a gene has the DNA motif for a given TF in its regulatory region and was also predicted by co-expression, it strengthens confidence that the TF may directly regulate that gene. The output is a collection of **regulons** (each TF’s set of likely target genes) and an *expression matrix filtered to these genes*. (SCENIC also scores regulon activity per cell, but here the main use is to obtain the network structure.)
   * **Network Pruning and Refinement:** The raw network from SCENIC can be large and include many weak or irrelevant connections. The pipeline prunes it in several steps to focus on the core regulatory interactions pertinent to the aging trajectory. We first restrict the network to the genes of interest (the DEGs/switch genes identified earlier), discarding any TF→target edges where the target gene is not in our trajectory gene list. Then, using the smoothed expression data, we calculate the Spearman correlation for each remaining TF–target pair across pseudotime. This provides a sign for each interaction: a high positive correlation suggests the TF *activates* the target (they rise and fall together), whereas a strong negative correlation suggests the TF *represses* the target (inverse relationship). We drop any edges with low correlation magnitude, applying a stringent threshold (e.g. |ρ| < 0.7 are removed) to ensure we keep only robust relationships. Next, we eliminate **terminal nodes** – genes that have no outgoing edges (out-degree = 0) after the above pruning. Such genes, often targets that don’t regulate others, do not affect network dynamics and can be excluded to simplify the model. Removing them effectively focuses the network on regulatory genes that form feedback loops or cascades driving the system’s state. We then examine the pruned directed graph for **strongly connected components (SCCs)** – groups of genes that mutually regulate one another (forming feedback loops). Each SCC is collapsed into a single “meta-node” for modeling purposes, since the genes in an SCC tend to behave as an integrated module. This contraction reduces complexity and highlights modular structure in the GRN. Finally, for each gene (node) in the network, we ensure it has at least one activator input. If a gene was only under net inhibition or had no incoming edges (which could happen if all its regulators were removed as terminal nodes), we introduce a self-activation loop on that gene. This is a logical addition meaning the gene can maintain its state by itself if no other activator is present. The result of these steps is a refined **Boolean network topology**: a set of nodes (key genes or gene modules) connected by signed directed edges (activation or inhibition) that encapsulate the regulatory architecture of the aging trajectory. This network is significantly smaller than the full transcriptome, focusing on \~10²–10³ genes, and is suited for dynamic simulation.

6. **Binarization and Boolean Rule Extraction:** With the GRN structure in hand, the pipeline next derives the *Boolean rules* governing each gene’s on/off state. We leverage the fact that single-cell expression (after smoothing) can be thresholded into binary values indicating gene *ON* (high expression) or *OFF* (low expression). GeneSwitches already provided a binary matrix by applying a cutoff (fixed at the 20th percentile of expression) to the smoothed data. Using this binarized time-course, we construct truth tables for each gene’s regulation. For a given target gene, consider all the regulator genes that have incoming edges into it (as determined in the pruned network). We gather the pseudotime-ordered binary states of those regulators as input vectors, and the binary state of the target gene at a later time point as the output. Specifically, the pipeline forms input/output pairs {(I\_t, O\_{t+k})} by taking the regulator states at cell/time *t* and the target’s state at time *t + k* along pseudotime. The step size *k* is chosen such that the input window and output window do not overlap in time (for example, *k* is set to roughly 1.5 times the smoothing window size). This ensures we’re capturing causal-like relationships (regulator state preceding the target’s change). We require a minimum number of such pairs (e.g. >5) for each gene to learn a reliable rule; genes with too few state transitions are skipped or defaulted. Given the input-output pairs for a target gene, we then search for the Boolean function *f* that best explains the gene’s behavior. In practice, since the number of regulators per gene is limited (we capped at 3 incoming regulators for tractability), an exhaustive or semi-greedy search can evaluate possible truth tables. Each candidate function is scored by the **agreement score** S(f) = ∑*t S\_t(f), where S\_t(f) = 1 if the function’s prediction f(I\_t) matches the observed output O*{t+k}, and 0 if not. Essentially, S(f) counts how many of the input/output examples the function gets right. We select the Boolean rule that maximizes this score for the gene. If multiple distinct logic formulas achieve the top score, the pipeline retains all of them – interpreting ties as evidence of possible alternative regulatory modes. Rather than arbitrarily pick one, it **combines tied solutions with a logical OR** to form a composite rule. (For example, if gene X was equally well explained by “A AND B” and by “C” as separate rules, the final rule would be “(A AND B) OR C”.) This approach preserves logical redundancies and ensures that the Boolean model is not overly rigid if multiple pathways can activate a gene. At the end of this stage, each gene in the GRN is assigned a Boolean update rule (with regulators ≤3) that will govern its state in simulations. The collection of all these rules constitutes the **Boolean regulatory model** of the aging process.

7. **Attractor Simulation and Analysis:** The Boolean GRN model – a network topology plus Boolean transition rules – is then subjected to dynamical simulation to identify its long-term stable states. Using the BoolNet R package, we run *synchronous update* simulations: starting from many random initial states (random ON/OFF assignments to all genes), we iteratively update all genes according to their Boolean functions, generating state transitions until the system converges. Every Boolean network will eventually settle into either a steady-state configuration or a repeating cycle; these are the **attractors** of the network. For our purposes we treat attractors as fixed points (steady states in gene expression) since synchronous Boolean networks often yield point attractors for networks of this size. We perform extensive attractor searches across different runs and also explore how results vary with different hyperparameter choices (e.g. if we alter the smoothing window or step size *k*). The outcome is an **attractor landscape**: typically a handful of attractor states, each with an associated *basin of attraction* (the set of initial states that lead to that attractor). We analyze the attractors to interpret cell fates in the context of aging. In an ideal scenario, we expect an attractor that corresponds to a “young-like” stable state and one that corresponds to an “old-like” state, since the trajectory started in young cells and ended in old cells. Indeed, we define two reference expression patterns from the data: the average binarized expression profile of the cells in the first 20% of pseudotime (early in the trajectory) is taken as the **Young reference state**, and similarly the average of the last 20% of cells as the **Old reference state**. Each attractor found via simulation can then be compared to these references. To quantify an attractor’s position along the youthful-to-aged spectrum, we project its state vector onto the axis connecting the Young (normal) and Old (aged) reference vectors. The **distance d<sub>k</sub>** of attractor *k* from the Young state is calculated (via a dot product formula) such that d = 0 means identical to the Young reference and d = 1 means identical to the Old reference. This effectively gives each attractor a *pseudo-chronological* score between 0 and 1 indicating how aged that state is. We also examine the *basin size* of each attractor (what fraction of random initial conditions lead to it) as a measure of its reach or dominance in the network’s dynamics. Furthermore, the pipeline evaluates **attractor stability** by perturbation analysis. For each attractor, we introduce small random perturbations (flip the state of a randomly chosen gene) and observe where the network settles: does it return to the same attractor or transition to a different one? Over many such perturbations, we compute an **entropy** measure for the attractor’s basin: if perturbations frequently knock the system into other attractors, the entropy is high (indicating a shallow or fragile attractor basin), whereas if perturbations stay in the same attractor, the entropy is low (a deep, stable basin). We normalize this “attractor entropy” relative to the theoretical maximum (which would be a uniform probability of ending in any of N attractors, entropy = log2 N). In summary, after this analysis we have for each attractor: (a) a Young-vs-Old distance d<sub>k</sub>, (b) a basin size (percentage of states), and (c) a relative stability (depth) represented by 1 – (S<sub>k</sub>/S\_max). These metrics allow us to interpret each attractor as potentially youth-like or age-like and how stable each state is. Often, we find one attractor that represents an “old” state with a large basin (dominant outcome) especially if the trajectory was strongly unidirectional, and possibly additional smaller attractors that might represent intermediate or alternative states in the transition.

8. **In Silico Perturbation and Rejuvenation Scoring:** The final stage uses the validated Boolean model to systematically test gene perturbations **in silico** and evaluate their effect on the cell state landscape. We introduce *perturbations* by *fixing* the value of one or more genes to 0 (permanent knockout/inhibition) or 1 (forced overexpression) and then re-running the Boolean network simulation to find new attractors. Essentially, this simulates a gene therapy or drug effect that holds a gene “OFF” or “ON” constitutively. For each gene in the network, we perform two simulations (gene fixed OFF and fixed ON, unless one of those is trivial) and recompute the attractor landscape metrics, in particular the **aging score** of the network. The **aging score** is a scalar summary of the landscape’s bias toward old vs young attractors, computed from the attractor distances, stabilities, and sizes as described above. One implementation is to sum over all attractors the product of (basin fraction) × (attractor distance d<sub>k</sub>) × (attractor depth factor = 1 – S<sub>k</sub>/S\_max). Intuitively, this quantifies “how far along the aging trajectory the network is,” accounting not just for the presence of an old-state attractor but also how predominant and stable it is. The higher the score, the more the network’s steady states are skewed toward an aged outcome. We take the initial (unperturbed) network’s score as representing the *transition state*. We then identify **which single-gene perturbation yields the greatest reduction in the aging score** – this gene is the top candidate for a rejuvenation target. Conceptually, knocking out or overexpressing this gene in the model shifts the balance of attractors most toward the youthful side (for example, it might eliminate an old attractor or make the young attractor dominant, thereby lowering the overall score). In our analysis, we only consider cases where the original transition state had a relatively high aging score (>0.5 on a 0–1 scale) to ensure there is room for improvement. A successful *reversion* is defined as achieving a final score ≤0.1, i.e. pushing the system very close to the youthful state. In practice, a single gene perturbation might not always accomplish this (especially in complex networks). Therefore, the pipeline also explores **dual perturbations**: it takes the top few single-gene hits (e.g. top 5) and tests all pairwise combinations of perturbing two genes simultaneously. For each pair, it computes the new score. Often, combinations can have synergistic effects that drive the network closer to youthful attractors than any single gene alone. The best pair (the two-gene combination that minimizes the aging score) is identified as a potential *combination therapy* strategy. As an extra analytical step, if the two genes in the optimal pair are both transcription factors (which is likely, since TFs are prominent regulators in the GRN), we trace them back into the regulon network: using the SCENIC-inferred GRN, we find the **common target genes** that both TFs regulate. Those common downstream genes (which might be effectors of cell state) are flagged as **ultimate candidate genes for reversion**. The rationale is that if two master regulators both converge on certain targets, those targets or the processes they represent could be key leverage points for rejuvenation. In summary, this perturbation analysis yields a ranked list of single-gene interventions (with their predicted effect sizes on the aging score) and, if needed, a recommended two-gene intervention for maximal rejuvenation. By fixing gene states in silico and observing attractor shifts, we effectively simulate **interventions** and measure their efficacy in resetting the cell’s regulatory network to a younger equilibrium.

## Core Algorithms and Tools

This pipeline leverages a number of computational methods and software tools, each addressing a specific aspect of the analysis:

* **Trajectory Inference (Monocle3):** To order cells by pseudotime, Monocle3 constructs a principal graph through the high-dimensional transcriptomic space of a single-cell experiment. We used Monocle3’s DDRTree/UMAP-based approach to learn this graph and define a continuous trajectory from young to old cells. The root of the trajectory was explicitly set using prior knowledge (youngest donor’s cells) to give directionality. Monocle’s algorithm clusters cells and fits a minimal spanning tree with flexible branches (“learn\_graph”), then orders cells (assigns pseudotime) along the path from the root through the graph. This yields a pseudotemporal ordering reflecting an *aging progression*. Monocle3 also provides the graph test for differential expression on the trajectory, which we utilized to find significant genes.

* **GeneSwitches for Switch-Gene Detection:** GeneSwitches is an R toolkit designed to find genes that exhibit switch-like behavior along a trajectory. It uses logistic regression to model each gene’s expression as a sigmoid function of pseudotime, detecting where a gene “switches” on or off. In our pipeline, GeneSwitches took the smoothed pseudotime expression and produced a set of candidate switching genes with their on/off transition points. This adds a layer of insight beyond simple monotonic DEGs by highlighting thresholded changes – genes that might act as binary regulators or state markers. The logistic modeling helps rank genes by how cleanly they switch (via R² or similar metrics), focusing on those with sharp expression transitions. These genes often correspond to key regulatory events (e.g. transcription factors getting activated or repressed at a particular stage of aging).

* **GRN Inference via SCENIC (GENIE3 + RcisTarget):** To infer regulatory interactions, we relied on the SCENIC pipeline which combines **GENIE3** and **RcisTarget**. GENIE3 uses an ensemble of regression trees (random forest) to predict each gene’s expression from all others, effectively scoring potential regulator→target relationships. It’s data-driven and can capture nonlinear associations. We applied GENIE3 to the smoothed, log-transformed expression matrix of our trajectory genes, yielding an importance-weighted adjacency matrix. Then, RcisTarget was used to incorporate prior knowledge: it scans the upstream regions of genes for enriched transcription factor binding motifs. For example, if GENIE3 suggests TF A may regulate gene X, RcisTarget checks if gene X’s promoter has motifs for TF A; if yes (and statistically significant across the set of A’s top targets), the link A→X is retained as a regulon edge. This motif-based validation grounds the GRN in known biology, filtering out spurious correlations that lack any cis-regulatory basis. The result is a **regulon network**: a set of TFs each with a list of target genes that they likely control. In our case, we focused on regulons that overlap with the pseudotime DEGs. SCENIC thus provided an initial network which we then pruned heavily using trajectory-specific data (correlation and significance) as described above. The combination of GENIE3 and RcisTarget ensures the GRN has both **data fidelity** (learned from our experiment’s expression patterns) and **biological plausibility** (supported by known TF-DNA interactions).

* **Network Pruning and Topology Processing:** After SCENIC, additional graph algorithms were applied to refine the network. We computed Spearman correlations for TF–target pairs on the pseudotime series to assign interaction signs (activation/repression). This step effectively transforms an undirected co-expression link into a directed, signed influence, leveraging temporal ordering (if TF lags or leads target, though we mostly use correlation as symmetric measure of trend). The absolute correlation threshold (0.7 in our case) acts as a stringent filter to remove weak or inconsistent relationships. The removal of terminal nodes (nodes with no outputs) was done by analyzing the directed graph: any gene that does not regulate others was dropped to simplify the model. We used the igraph library to identify **strongly connected components (SCCs)** – sets of nodes with mutual reachability, indicating feedback loops. We then *contracted* each SCC into a single node (using igraph’s `contract.vertices`) so that the Boolean model treats the whole strongly connected subnetwork as a unit. This is justified because within an SCC, the genes tend to toggle collectively due to their interdependencies. Finally, the insertion of self-activation loops for orphan nodes was a rule-based augmentation to ensure no node is purely a slave to inhibitors. These graph operations produce a leaner yet dynamically competent network for Boolean simulation. The use of graph algorithms (finding SCCs, computing in-degrees/out-degrees, etc.) is crucial for reducing the state-space to a manageable size and focusing on key regulatory circuits.

* **Boolean Rule Learning Algorithm:** For each gene, given its regulators (usually a small number after pruning), we needed to determine the Boolean logic (e.g. AND, OR, NOT combinations) that governs its activation. Our approach implements a brute-force or heuristic search over possible Boolean functions of *n* regulators. Because we limited *n* to at most 3, the total number of possible Boolean functions is finite (for 3 inputs, 2^(2^3) = 256 possibilities). We used a **scoring function** S(f) that counts matches between the function’s predictions and the observed future outputs in the data-derived input/output pairs. Essentially, for each candidate truth table, we simulated it on the input sequences and tallied how often it correctly predicts the target gene’s binarized expression at the next time window. The function(s) with the highest score S(f) were selected as the best explanation for that gene’s regulation. Ties were resolved by taking the union (logical OR) of equally optimal rules. We developed this custom algorithm inspired by methods in **pseudotime network inference** literature, ensuring that the Boolean rules capture temporal dependencies implied by the pseudotime ordering. This data-driven logic inference is what makes the network *executable*: unlike a static correlation network, we now have update functions that allow state evolution to be simulated.

* **Attractor Finding (BoolNet):** BoolNet is an R package that provides tools for Boolean network simulations and attractor detection. We employed BoolNet’s synchronous update functionality to simulate the entire network over many iterations. BoolNet can also directly compute attractors by exhaustive state space search for smaller networks, though for moderate sizes we used simulation-based approximation (random restarts). By enumerating or randomly sampling initial states and applying the update rules, BoolNet identifies the unique steady states or periodic cycles that the network settles into. We specifically looked for **point attractors** (steady states) as these represent distinct stable gene expression profiles (e.g. a stable young-like state vs a stable old-like state). BoolNet returns each attractor’s state configuration and can provide the basin size by counting how many initial states led to it. We compiled attractor statistics across different parameter variations to see which attractors consistently appear (robust attractors). The use of BoolNet greatly facilitated the analysis of the Boolean model’s long-term behavior, giving us confidence that the attractors identified are not artifacts of a single run but inherent to the network logic.

* **Attractor Metrics – Distance and Entropy:** We implemented custom calculations to quantify each attractor’s properties in biologically meaningful terms. The **distance to young vs old attractor** is computed by treating the binary gene expression vectors as points in high-dimensional space and projecting onto the line between the reference young and old points. This yields a continuous value *d* per attractor (0 ≤ d ≤ 1) indicating its relative position. This concept is akin to defining a one-dimensional “aging axis” in state space and measuring how far an attractor has progressed along it. The **attractor entropy (stability)** was calculated via repeated perturbation experiments: for many states in the attractor’s basin, we introduced a single-gene perturbation and observed the resulting attractor. If an attractor is very stable, most such perturbations still return to it; if it’s on the verge of tipping to another state, perturbations will often land in a different attractor. We summarized these outcomes using entropy (higher when outcomes are more uncertain/dispersed). By averaging entropy across the basin, we obtained S<sub>k</sub> for attractor k, and normalized it by the maximum possible entropy log2(N) for N attractors. The term (1 – S<sub>k</sub>/S\_max) thus serves as a proxy for “attractor depth” – closer to 1 means a deep, stable valley; closer to 0 means a shallow, easily disturbed valley. These metrics were crucial for defining the **aging score** of the network state. The score formula we used combines: basin size (width of valley), depth of valley, and position along the normal-old axis. It essentially weights each attractor’s contribution to overall aging by how prevalent and stable that attractor is. This allowed us to condense a complex attractor landscape into a single number for easy comparison before and after perturbations.

* **Perturbation Strategy and Target Identification:** The in silico perturbation analysis involved systematically altering the network and recomputing attractors. We utilized BoolNet’s ability to *fix genes* (using `fixGenes` or by modifying update rules) to simulate gene knockouts (fix value = 0) or constitutive activation (fix value = 1). For each such modified network, we recomputed the attractor landscape and the associated aging score. Automating this allowed us to screen every gene. The “optimal target gene” is defined as the one whose perturbation yields the largest drop in the aging score compared to baseline. We also introduced a cutoff for meaningful reversion (final score ≤ 0.1, given initial > 0.5) to identify truly effective interventions. The pipeline’s strategy then extends to *combination perturbations*: we perform a combinatorial search, typically taking the top few single candidates and evaluating all pairs. While exhaustive search over all pairs would be too many, restricting to top 5 or 10 singles is computationally feasible and likely to include the best pair. For each gene pair, we simultaneously fixed both genes and measured the new score. The best pair (maximal score reduction) is chosen as the leading combination therapy candidate. Finally, recognizing that our top interventions often involve TFs, we interpret the results via the regulon network. Specifically, the pipeline finds **common target genes** that are downstream of both TFs in the best pair. These common targets may represent key downstream pathways or nodes that integrate the effect of both interventions. Highlighting them provides a short-list of potential *drug targets* (for example, if both TFs converge on a certain growth factor gene, that gene or its product could be an actionable target to replicate the effect). In summary, the perturbation analysis is a *virtual screening experiment*, employing the Boolean model as a testbed to find genetic interventions that restore a youthful network state. It mirrors the patent’s proposed method of using an executable logical network to identify therapeutic targets by simulation, and it leverages BoolNet’s perturbation functions to do so systematically.

## Interpretation Framework

The framework for interpreting results revolves around comparing the network’s attractor states to known biological phenotypes (young vs old) and quantifying the “agedness” of the system in a way that guides target selection. We map the **attractors** obtained from the Boolean model to the real biological states by using the starting and ending cell populations as references. By defining the Young and Old reference gene expression patterns from the actual single-cell data (early vs late pseudotime average), we ensure that each model attractor is evaluated in terms of real gene expression extremes. An attractor with many genes in the “Old” (upregulated in aged cells) state will have a distance *d* close to 1, whereas an attractor resembling the youthful gene expression signature will have *d* near 0. This way, attractors are conceptually placed on a **continuous aging axis**. If multiple attractors exist, it is possible (for example) to have one attractor correspond to a predominantly young-like state, and another correspond to an old-like state – with the network’s initial condition (the transitional cell population) perhaps showing a mix of tendencies or residing closer to the old attractor due to the trajectory’s bias.

The **aging score** condenses the attractor landscape into a single value that indicates how far the system has drifted toward the undesirable state (old age). A higher score means the dominant attractors are closer to the old state and/or very stable (deep), which implies that the cell type in question is firmly in an aged program. A lower score means either the youthful state is dominant or the old state is unstable/shallow. We interpret this score as a proxy for the *biological age* of the cellular network. In an initial unperturbed trajectory, the score tells us how advanced the aging process is in that transitional population. Importantly, this framework treats aging as potentially reversible – if we can find a way to alter the network so that a young attractor becomes dominant (and the old attractor either disappears or becomes shallow), the score will drop accordingly.

**Rejuvenation potential** is thus assessed by how much we can reduce the aging score through interventions. The interpretation is that a successful intervention reconfigures the attractor landscape such that the cell’s stable equilibrium state shifts towards a younger phenotype. For practical thresholds, we considered a final score ≤0.1 as effectively *rejuvenated*, given that means the network’s attractors are overwhelmingly on the youthful end. The requirement that the initial score be >0.5 for the analysis to proceed ensures we’re dealing with a significantly aged baseline that needs intervention – otherwise, if a cell population is already near youth (low score), we wouldn’t need a “rejuvenation” strategy.

After perturbation simulations, each gene (or gene pair) is interpreted in terms of its ability to cause a *network-wide shift*. A gene that lowers the score substantially when knocked down/up is inferred to be a **driver of aging** in that cell type – perhaps a pro-aging factor if its knockout rejuvenates, or an anti-aging factor if its overexpression rejuvenates (depending on which action gave the benefit). Similarly, a pair of genes that together have a dramatic effect might indicate two parallel pathways that need to be modulated in concert to push the system back to youth. By mapping these critical genes onto the known regulon network, we can also interpret *why* they have that effect – for instance, two TFs might each control a subset of aging-related genes, and only by fixing both do we silence the entire aging program. The **common target genes** identified for a top TF pair help in this interpretation: those targets could be central nodes (hubs) that integrate signals from both TFs and execute the aging program, so if both TFs are inhibited, those hubs are effectively suppressed. In a broader sense, the interpretation framework connects the abstract attractor analysis back to concrete biology: we end up with hypotheses like “Gene X and Gene Y maintain the aged state of keratinocytes by redundantly activating a pro-aging gene program Z; targeting both could release the cells into a more youthful state.”

Additionally, the presence of multiple attractors in the unperturbed network can be interpreted as indicating *plasticity* or heterogeneity in cell states. For example, if we saw both a young-like and an old-like attractor with moderate basins, it suggests that even without intervention, some cells (or cell sub-states) have the potential to revert to a younger state (if they fall into the young attractor basin), but perhaps the old attractor is slightly more stable or larger. An ideal intervention not only makes the young state more stable (depth increase, entropy decrease) but also enlarges its basin (so more initial conditions lead there). This is reflected in the score calculation (since both depth and basin size factor in). Thus, when interpreting an intervention, we look qualitatively at how the attractor landscape changed: Did the old attractor disappear or move closer to young? Did the young attractor’s basin size grow from, say, 20% to 80% of initial conditions? Did the entropy of the old state increase (meaning it’s less stable)? Such changes underpin the quantitative drop in aging score and give insight into the network’s altered dynamics.

In summary, the interpretation framework ties together: (1) **Attractor identification** (mapping to known cell states), (2) **Quantitative scoring** of network “age” (to compare before vs after perturbations), and (3) **Mechanistic reasoning** via network topology (understanding which regulatory circuits were broken or restored by a perturbation). This provides a comprehensive picture: not only a ranked list of candidate interventions, but also a rationale for their effect rooted in the model of gene regulation. It’s a powerful way to make sense of complex single-cell data in aging – converting descriptive signatures into predictive, testable hypotheses about reversing cellular age.

## Outputs and Applications

The pipeline produces several valuable outputs that can drive further research and development:

* **Prioritized Gene Targets:** A ranked list of genes emerges from the in silico perturbation screen, highlighting which single-gene perturbations would most effectively rejuvenate the cell’s state. For each gene, we report the predicted change in the aging score (or a similar reversion metric) upon its knockdown or overexpression. This informs experimentalists which genes are promising to manipulate in *in vitro* or *in vivo* models of aging. Typically, the top-ranking gene (or a few genes) are master regulators of the aging process in that cell type – for example, key transcription factors or signaling molecules that, when inhibited, cause a broad reset of the transcriptome toward youth. These are prime candidates for drug targeting.

* **Optimal Combinatorial Intervention:** In cases where no single gene yields a full reversion (score < 0.1), the pipeline identifies an optimal *pair* of genes for dual intervention. It provides the combination that showed the greatest synergy in silico. Along with this, the analysis often notes the **mechanism**: e.g., “Gene A + Gene B together cover distinct arms of the aging network, and both must be perturbed to collapse the old attractor.” This output guides combination therapy design – suggesting, for instance, that drugs inhibiting both targets could be applied together to achieve rejuvenation. Notably, the pipeline narrows down from potentially dozens of genes to just a couple of high-impact combinations, focusing experimental validation on the most promising pairs.

* **Common Downstream Effectors:** For the top gene pair, the pipeline outputs the common target genes regulated by both, as extracted from the regulon/GRN. These downstream effectors can themselves be potential drug targets or biomarkers. If two upstream regulators converge on a set of genes that drive cell aging (e.g., pro-inflammatory or cell-cycle genes), those downstream genes might be easier to target (for instance, via small molecules) or monitor as readouts. Thus, the final “ultimate candidate genes for reversion” can include not just the regulators (which might be transcription factors, sometimes hard to drug) but also the pathway genes they control, providing alternative intervention points.

* **GRN Model and Attractor Insights:** The Boolean GRN model itself is an output – typically provided as a set of logical rules or a state transition graph. This model can be examined to gain insight into the regulatory logic of aging in the studied cell type. For example, researchers can inspect the Boolean rules to see combinations of signals that activate certain downstream genes (e.g., “Gene X turns on only if Y is off and Z is on”, indicating a regulatory circuit). The attractors of the model correspond to distinct gene expression patterns; by comparing the attractor states, one can characterize what changes from the young state to the old state (which genes are differently expressed, which feedback loops are engaged, etc.). We often output the attractor states in terms of gene lists (which genes are ON in old attractor vs young attractor) or even reconstruct a notional expression profile for those states. This helps in understanding the hallmarks of aging in that cell type at the network level.

* **Visualization Products:** The pipeline generates a variety of plots for analysis and presentation. During QC and clustering, UMAP plots colored by age help confirm that older donor cells occupy distinct transcriptional neighborhoods. For each cell type trajectory, pseudotime plots or dendrograms illustrate the branching (Monocle’s plot of the principal graph can be used to show the trajectory from young to old). **Gene expression switch plots** (from GeneSwitches) can be created, which show when along pseudotime each “switch gene” is flipped on or off – this can be visualized as a waterfall plot or heatmap, giving an intuitive timeline of gene activation events. The GRN can be visualized as a network graph: nodes (genes) and directed edges (with color/style distinguishing activation vs inhibition). Important substructures like SCCs might be highlighted (since those are merged in the model, one could show them as clusters in the graph). A particularly insightful visualization is the **attractor landscape**. While the true state space is high-dimensional, we often create a conceptual 2D or 3D landscape diagram where valleys represent attractors. In our analysis, we even fit a surface (using the `persp` function in R) to depict how attractor “valley depth” vs “position along aging axis” might look. In such a plot, one axis might be the normal-to-old axis (d), another could represent some orthogonal variation, and the depth of the valley corresponds to stability. These landscapes, while schematic, help stakeholders visualize the idea that the unperturbed system has, say, a deep valley at an old state and a shallower valley at a young state – and that perturbations aim to “fill in” the old valley and deepen the young valley (effectively shifting the balance). Lastly, bar charts or line charts are produced to summarize perturbation outcomes: e.g., a bar graph of aging score before and after perturbation for top 10 genes, showing how each intervention improves the score.

* **Usage Scenarios:** The outputs of this pipeline can be applied in multiple contexts. Primarily, it provides a rational basis for **drug target discovery in aging**: by pinpointing which gene modulations can drive cellular rejuvenation, it informs the development of gene therapies or small-molecule drugs. For instance, if the pipeline finds that turning off a certain transcription factor massively rejuvenates cells in silico, one could screen for inhibitors of that factor’s activity as potential anti-aging compounds. The approach is general and can be applied to any transition of interest, not just normal aging. In a disease context, the “young” vs “old” could be replaced by “healthy” vs “diseased” cell states – the same Boolean modeling and perturbation analysis could then identify reversion targets for, say, fibrosis, neurodegeneration, or cancer. In regenerative medicine, one could use this pipeline to find factors to revert a differentiated cell to a more stem-like state (somewhat analogous to Yamanaka factors, but data-driven). Another application is **biomarker discovery**: the common target genes and the attractor-state gene signatures might serve as biomarkers of aging or rejuvenation. For example, if the model predicts that a set of inflammation genes go off when rejuvenation is achieved, those genes could be measured as biomarkers to evaluate treatment efficacy in experiments or clinical trials. Finally, the Boolean model can be exported to simulation software or converted to ODE models for further analysis, making it a starting point for more detailed dynamic modeling. The simplicity of Boolean rules also allows hypothesis generation – scientists can read the logical rules and propose experiments (e.g., “Gene A AND Gene B need to be off to turn Gene C on – let’s verify if that’s true in the lab”). In summary, the deliverables equip researchers with both specific testable targets and a broader systems-level understanding of the aging process in the cell type studied.

## Integration with Patent Framework

The methods implemented in this pipeline closely correspond to the inventions claimed in the related patent application, which describes a system for identifying therapeutic targets by modeling gene regulatory dynamics of aging (or disease) and performing computational perturbations. Key elements of the pipeline map to specific innovative steps in the patent:

* **Pseudotime-Derived Transition Model:** The patent outlines using single-cell omics data to define a trajectory between a baseline state and an aged (or pathological) state, providing the foundation for network inference. In our implementation, this is achieved via Monocle3 pseudotime ordering from young to old cells. By choosing the biologically relevant trajectory (e.g. normal-to-disease progression), we fulfill the patent’s requirement of focusing on the transition of interest. The use of youngest cells as root and the selection of the correct branch (based on correlation with age) ensure the model captures the intended normal→aged progression, as described in the patent’s approach to trajectory selection.

* **Knowledge-Integrated GRN Construction:** The patent emphasizes constructing a gene regulatory network that leverages prior knowledge (e.g. known TF-target relationships) combined with experimental data. Our pipeline’s use of the SCENIC workflow (GENIE3 + RcisTarget) directly reflects this. GENIE3 provides a data-driven co-expression network, and RcisTarget integrates motif databases to refine regulatory links. This matches the patent’s claims of using a hybrid approach to network inference – where known cis-regulatory motif enrichment is used to inform and validate the predicted connections. The result is a network of interactions grounded in established biology, which the patent likely cites as a means to improve the relevance and accuracy of the model.

* **Dynamic Network Pruning and Boolean Formalism:** A notable aspect of the patent is the conversion of complex omics data into a simplified dynamic model (in this case, a Boolean network). Our steps of pruning weak connections (correlation thresholding), removing non-informative nodes, and condensing strongly connected loops are all geared towards distilling a minimal yet functional network. The patent claims include formulating Boolean rules for each gene based on the trajectory data. We implemented the scoring-based Boolean rule inference to capture regulatory logic, exactly as the patent describes (the patent document even provides the definition of the score function S(f) and the selection of the highest-scoring Boolean functions, which we incorporated into our pipeline). The addition of self-regulatory loops for genes lacking activators aligns with the patent’s approach to ensure the network is fully connected and can maintain state, an important detail mentioned in the patent to allow meaningful simulation.

* **Attractor Analysis and State Quantification:** The patent introduces the concept of analyzing the Boolean network’s attractors to quantify cell state or deviation from the healthy baseline. In our pipeline, we performed this attractor analysis using BoolNet and computed metrics like basin sizes, and more critically, the distance of each attractor from the normal (young) state. The patent specifically describes constructing a normal-to-aged axis in state space and projecting attractors onto this axis to measure how close they are to the normal vs diseased phenotype. We followed that method to obtain the distance *d\_k* for each attractor. Furthermore, the patent defines an “attractor entropy” to measure stability (depth of attractor basins) and incorporates that into a composite *aging score*. Our pipeline implemented this exactly: for each attractor we calculated entropy via perturbation experiments and then computed the overall score as a sum of attractor contributions weighted by distance and basin depth. This score, as conceived in the patent, is crucial for comparing pre- and post-perturbation network states. By reproducing this calculation, we directly operationalized the patent’s idea of quantifying how “aged” a cell state is based on its GRN attractor landscape.

* **In Silico Perturbation for Target Identification:** A core inventive step in the patent is the use of the Boolean network to simulate gene perturbations (knockouts/overexpression) and predict their impact on shifting the cell’s attractor landscape to a more normal state. Our pipeline’s perturbation module corresponds one-to-one with this claim. We systematically fixed genes in silico to 0 or 1, recomputed attractors, and noted the change in the aging score. The patent describes identifying the gene whose perturbation yields the largest reduction in the aging score as the optimal therapeutic target – exactly what our ranking of single-gene interventions provides. We also adhered to the patent’s criterion of considering cases where the initial score is above a threshold (0.5) and defining success as reducing the score below a threshold (0.1). These numeric thresholds and the notion of a “successful reversion” are taken directly from the patent’s methodology and were implemented in our analysis to flag truly effective interventions.

* **Combination Therapies and Convergent Targets:** The patent further extends the idea to combinations of perturbations when single interventions are insufficient. In line with this, we evaluated pairwise gene perturbations among the top candidates, as per the patent’s suggestion of examining combinations of the best single targets. We identified the most effective gene pair that brings the score down to youthful levels. The patent notes using the BoolNet `fixGenes` function for multi-gene perturbation, which we likewise used to simultaneously fix two genes and simulate outcomes. A distinctive aspect of the patent is the step of mapping the best two-gene combination onto the underlying regulon network to find common downstream genes. We executed this by tracing the two TF candidates in the SCENIC-inferred network and extracting their shared targets. The result – a set of common target genes proposed as “ultimate” reversion targets – directly follows the patent’s claimed approach. This not only validates the patent’s concept but also provides a tangible list of genes that could be co-regulated by the two master regulators, offering insight into the mechanism of reversion.

In summary, each component of our pipeline was developed to mirror the innovative steps laid out in the patent application. From the construction of a pseudotime-based Boolean network, through attractor landscape quantification, to perturbation-driven target discovery, our implementation serves as a practical realization of the patent’s framework. The **patent’s claims** are effectively embodied in this pipeline: we have demonstrated how to computationally derive a ranked list of candidate interventions (single genes or combinations) that can revert an aged or diseased cell state to a youthful/normal state, using a logical model built from single-cell data. By preserving the logical structure and metrics described in the patent (such as the score formula and perturbation criteria), the pipeline aligns with the intellectual property and provides a working reference for future applications of the patented method in aging research and drug discovery. The integration of these steps in a cohesive workflow underscores the practicality and power of the approach, validating the patent’s core ideas with real data and setting the stage for experimental validation of the predicted rejuvenation targets.
